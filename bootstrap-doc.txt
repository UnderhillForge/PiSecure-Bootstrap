# PiSecure Bootstrap Node Documentation

## Overview
PiSecure Bootstrap Nodes are intelligent, ML-powered network coordinators that provide advanced peer discovery, attack detection, and routing optimization capabilities. Unlike traditional bootstrap services, PiSecure nodes actively monitor network health, detect threats, and optimize routing in real-time.

## Unique Features

### 1. Intelligent Bootstrap Handshake System
**Purpose:** Secure, coordinated bootstrap node registration and service discovery.

#### API Endpoint: `POST /api/v1/bootstrap/handshake`
**Description:** Register secondary bootstrap nodes with the primary node for coordinated operation.

**Request Body:**
```json
{
  "node_id": "bootstrap-secondary-01",
  "address": "192.168.1.100",
  "port": 8081,
  "services": ["peer_discovery", "network_health"],
  "capabilities": ["bootstrap_coordination", "peer_discovery", "network_health"],
  "region": "us-east",
  "version": "1.0.0",
  "reliability_score": 0.95,
  "load_factor": 0.2
}
```

**Response:**
```json
{
  "handshake_accepted": true,
  "primary_node": "bootstrap.pisecure.org",
  "node_id": "bootstrap-secondary-01",
  "registration_time": 1704379200.0,
  "network_info": {
    "total_bootstrap_nodes": 5,
    "active_services": ["coordination", "peer_discovery", "health_monitoring"],
    "protocol_version": "1.0",
    "coordination_enabled": true
  },
  "peer_discovery_endpoints": [
    "/api/v1/bootstrap/peers",
    "/api/v1/network/status"
  ]
}
```

**Unique Features:**
- Service capability validation
- Geographic region assignment
- Load balancing coordination
- Reliability scoring system

### 2. ML-Powered Attack Detection System
**Purpose:** Advanced anomaly detection using machine learning and statistical analysis.

#### API Endpoint: `GET /api/v1/intelligence/attacks`
**Description:** Get current attack detection analysis using ML algorithms.

**Response:**
```json
{
  "detected_attacks": [
    {
      "type": "ml_anomaly_detection",
      "severity": "high",
      "ml_score": -0.85,
      "confidence": 0.95,
      "timestamp": 1704379200.0,
      "description": "ML-detected anomaly with score -0.85"
    }
  ],
  "threat_level": "high",
  "analysis_period": "last_hour",
  "total_analyzed_connections": 1250,
  "ml_models_active": {
    "isolation_forest": true,
    "ensemble_classifier": true,
    "geographic_clustering": true
  },
  "recent_defense_actions": [],
  "active_threat_zones": ["us-east-high-risk"],
  "blocked_ips_count": 0,
  "blocked_regions_count": 0,
  "timestamp": 1704379200.0
}
```

#### API Endpoint: `GET /api/v1/intelligence/defense`
**Description:** Get comprehensive automated defense intelligence and status.

**Response:**
```json
{
  "defense_intelligence": {
    "automated_defense_active": true,
    "ml_attack_detection_enabled": true,
    "smart_routing_enabled": true,
    "threat_intelligence_level": "low",
    "active_attacks_detected": 0,
    "threat_zones_active": 0,
    "auto_response_actions": 0,
    "blocked_entities": 0,
    "defense_effectiveness_score": 95,
    "last_defense_action": null,
    "attack_prevention_rate": 0.92,
    "coordinated_defense_nodes": 3,
    "timestamp": 1704379200.0
  },
  "recent_attacks": [],
  "active_threats": [],
  "defense_capabilities": [
    "ML-powered anomaly detection",
    "Statistical attack pattern recognition",
    "Automated threat response",
    "Smart routing with threat avoidance",
    "Geographic attack clustering",
    "Real-time network immune system"
  ]
}
```

**Unique Features:**
- Isolation Forest ML algorithm for unsupervised anomaly detection
- Statistical attack pattern recognition (connection spikes, geographic anomalies)
- Real-time threat scoring and confidence levels
- Automated defense actions (rate limiting, regional blocking)
- Threat zone management and geographic attack clustering

### 3. Smart Routing Optimization Engine
**Purpose:** AI-powered peer routing with threat awareness and performance optimization.

#### API Endpoint: `POST /api/v1/intelligence/optimize`
**Description:** Get intelligent routing optimization for peer connections.

**Request Body:**
```json
{
  "available_nodes": [
    {
      "node_id": "node-001",
      "location": "us-east",
      "load_factor": 0.3,
      "reliability_score": 0.95
    },
    {
      "node_id": "node-002",
      "location": "eu-west",
      "load_factor": 0.1,
      "reliability_score": 0.98
    }
  ],
  "service_type": "p2p_sync"
}
```

**Response:**
```json
{
  "optimization_success": true,
  "service_type": "p2p_sync",
  "optimized_nodes": [
    {
      "node": {
        "node_id": "node-002",
        "location": "eu-west",
        "load_factor": 0.1,
        "reliability_score": 0.98
      },
      "score": 0.875,
      "geo_score": 0.9,
      "load_score": 0.95,
      "reliability_score": 0.98,
      "route_score": 0.8,
      "threat_adjusted": false
    }
  ],
  "total_candidates": 2,
  "optimization_method": "statistical_scoring",
  "scoring_weights": {
    "geographic_diversity": 0.3,
    "load_balancing": 0.4,
    "reliability": 0.3
  },
  "timestamp": 1704379200.0
}
```

**Unique Features:**
- Threat-aware geographic scoring
- Predictive load balancing
- Reinforcement learning route optimization (Q-table)
- Geographic clustering for regional optimization
- Real-time threat zone avoidance

### 4. Geographic Clustering and Network Analysis
**Purpose:** ML-powered geographic analysis for optimal network topology.

#### API Endpoint: `GET /api/v1/intelligence/clusters`
**Description:** Get geographic clustering analysis for routing optimization.

**Response:**
```json
{
  "geographic_clusters": {
    "0": {
      "locations": ["us-east", "us-central"],
      "total_traffic": 450,
      "centroid": [-95.7129, 37.0902]
    },
    "1": {
      "locations": ["eu-west", "eu-central"],
      "total_traffic": 320,
      "centroid": [10.4515, 51.1657]
    }
  },
  "clustering_method": "kmeans",
  "total_regions_analyzed": 5,
  "cluster_count": 2,
  "routing_optimization_available": true,
  "timestamp": 1704379200.0
}
```

**Unique Features:**
- K-means clustering for geographic region identification
- Traffic pattern analysis by region
- Centroid calculation for optimal routing hubs
- Dynamic cluster adaptation based on network conditions

### 5. Network Load Prediction Engine
**Purpose:** Predictive analytics for network capacity planning.

#### API Endpoint: `GET /api/v1/intelligence/predict`
**Description:** Get network load predictions for capacity planning.

**Response:**
```json
{
  "predictions": {
    "predicted_connections": 1500,
    "confidence": "medium",
    "timeframe_hours": 1,
    "method": "moving_average"
  },
  "confidence_level": "medium",
  "prediction_horizon": "1-24_hours",
  "data_points_used": 1000,
  "model_type": "statistical_time_series",
  "timestamp": 1704379200.0
}
```

**Unique Features:**
- Time series analysis for load forecasting
- Multiple prediction horizons (1-24 hours)
- Confidence scoring for prediction reliability
- Statistical moving average algorithms

### 6. Bootstrap Service Coordination
**Purpose:** Distributed service coordination among bootstrap nodes.

#### API Endpoint: `POST /api/v1/bootstrap/coordinate`
**Description:** Coordinate service distribution among bootstrap nodes.

**Request Body:**
```json
{
  "requesting_node": "node-client-001",
  "service": "peer_discovery"
}
```

**Response:**
```json
{
  "coordination_success": true,
  "service": "peer_discovery",
  "assigned_node": "bootstrap-secondary-02",
  "endpoint": "http://192.168.1.101:8082",
  "capabilities": ["bootstrap_coordination", "peer_discovery"],
  "load_factor": 0.15
}
```

**Unique Features:**
- Service load balancing across bootstrap nodes
- Geographic service optimization
- Reliability-based node selection
- Fallback coordination when primary services unavailable

### 7. Bootstrap Node Registry System
**Purpose:** Centralized registry and monitoring of all bootstrap nodes.

#### API Endpoint: `GET /api/v1/bootstrap/registry`
**Description:** Get the current bootstrap node registry.

**Response:**
```json
{
  "primary_node": {
    "node_id": "bootstrap-primary",
    "address": "bootstrap.pisecure.org",
    "port": 3142,
    "status": "active",
    "services": ["coordination", "peer_discovery", "health_monitoring"]
  },
  "secondary_nodes": [
    {
      "node_id": "bootstrap-secondary-01",
      "address": "192.168.1.100",
      "port": 8081,
      "services": ["peer_discovery", "network_health"],
      "capabilities": ["bootstrap_coordination", "peer_discovery"],
      "region": "us-east",
      "status": "active",
      "load_factor": 0.2,
      "last_seen": 1704379200.0
    }
  ],
  "total_nodes": 4,
  "last_updated": 1704379200.0,
  "coordination_status": "active"
}
```

**Unique Features:**
- Hierarchical bootstrap node architecture
- Service capability tracking
- Geographic distribution monitoring
- Load factor and health status reporting

### 8. Service Advertisement System
**Purpose:** Dynamic service capability advertisement and discovery.

#### API Endpoint: `POST /api/v1/bootstrap/advertise`
**Description:** Advertise current services and status.

**Request Body:**
```json
{
  "node_id": "bootstrap-secondary-01",
  "services": ["peer_discovery", "network_health", "attack_detection"],
  "status": "active",
  "load_factor": 0.25,
  "current_connections": 150,
  "health_metrics": {
    "cpu_usage": 0.45,
    "memory_usage": 0.67,
    "network_latency": 12.5
  },
  "service_endpoints": {
    "peer_discovery": "/api/v1/peers",
    "health_check": "/api/v1/health"
  }
}
```

**Response:**
```json
{
  "advertisement_accepted": true,
  "node_id": "bootstrap-secondary-01",
  "timestamp": 1704379200.0,
  "services_acknowledged": ["peer_discovery", "network_health", "attack_detection"]
}
```

**Unique Features:**
- Dynamic service capability updates
- Health metrics integration
- Load factor reporting for coordination
- Service endpoint discovery

### 9. 314ST Operator Rewards System
**Purpose:** Native PiSecure token rewards for bootstrap node operators.

#### Environment Variables (Railway Configuration)
```bash
BOOTSTRAP_OPERATOR_WALLET=pisecure_wallet_address
BOOTSTRAP_REWARD_PERCENTAGE=0.05
BOOTSTRAP_MINIMUM_PAYOUT=10
BOOTSTRAP_DAILY_BUDGET=1000
```

#### API Endpoints for 314ST Rewards

##### `POST /api/v1/operator/configure-wallet`
**Configure operator reward wallet**

**Request:**
```json
{
  "wallet_address": "pisecure_wallet_operator_abc123"
}
```

**Response:**
```json
{
  "configuration_success": true,
  "wallet_address": "pisecure_wallet_operator_abc123",
  "reward_percentage": 0.05,
  "minimum_payout_314st": 10,
  "timestamp": 1704379200.0
}
```

##### `GET /api/v1/operator/314st-analytics`
**Get comprehensive 314ST reward analytics**

**Response:**
```json
{
  "operator_analytics": {
    "operator_wallet": "pisecure_wallet_operator_abc123",
    "pending_rewards_314st": 25,
    "total_distributed_314st": 150,
    "recent_distributions": [...],
    "performance_score": 87.5,
    "daily_average_earnings": 8.5,
    "reward_configuration": {
      "percentage": 0.05,
      "minimum_payout": 10,
      "daily_budget": 1000
    }
  },
  "network_reward_info": {
    "daily_budget_314st": 1000,
    "intelligence_fee_percentage": 0.05,
    "active_bootstrap_nodes": 4,
    "reward_token": "314ST"
  }
}
```

##### `POST /api/v1/operator/314st-payout`
**Trigger manual 314ST payout**

**Response:**
```json
{
  "payout_success": true,
  "distributed_amount_314st": 25,
  "operator_wallet": "pisecure_wallet_operator_abc123",
  "distribution_timestamp": 1704379200.0
}
```

##### `GET /api/v1/operator/rewards-status`
**Get operator rewards status**

**Response:**
```json
{
  "operator_wallet_configured": true,
  "operator_wallet": "pisecure_wallet_operator_abc123",
  "reward_configuration": {
    "percentage": 0.05,
    "minimum_payout_314st": 10,
    "daily_budget_314st": 1000,
    "reward_token": "314ST"
  },
  "pending_rewards_314st": 25,
  "total_distributed_314st": 150,
  "last_payout_timestamp": 1704378200.0,
  "reward_eligibility": {
    "has_pending_rewards": true,
    "uptime_bonus_eligible": true,
    "federation_bonus_eligible": true
  }
}
```

**Unique Features:**
- Native 314ST token rewards (no external cryptocurrencies)
- Environment variable configuration for Railway deployment
- Performance-based reward bonuses (uptime, federation participation)
- Automatic batch payouts when thresholds reached
- Real-time reward analytics and tracking
- Quality-based intelligence contribution bonuses
- Geographic diversity bonus rewards

### 10. PiSecure DEX (Decentralized Exchange)
**Bootstrap-level DEX coordination with ML intelligence for optimal trading**

#### DEX Coordination APIs

##### `GET /api/v1/dex/pools`
**Get available liquidity pools for DEX trading**

**Response:**
```json
{
  "liquidity_pools": [
    {
      "pool_id": "314ST_wBTC_1704379200",
      "token_a": "314ST",
      "token_b": "wBTC",
      "liquidity_a": 50000,
      "liquidity_b": 25,
      "fee_percentage": 0.003,
      "trade_count": 150,
      "volume_24h": 5000,
      "pool_health_score": 85,
      "exchange_rate": 0.0005
    }
  ],
  "total_pools": 3,
  "dex_health_score": 87,
  "intelligence_enabled": true,
  "timestamp": 1704379200.0
}
```

##### `POST /api/v1/dex/pool/create`
**Create a new liquidity pool**

**Request:**
```json
{
  "token_a": "314ST",
  "token_b": "wBTC",
  "creator_wallet": "pisecure_wallet_creator"
}
```

**Response:**
```json
{
  "pool_created": true,
  "pool_details": {
    "pool_id": "314ST_wBTC_1704379200",
    "token_a": "314ST",
    "token_b": "wBTC",
    "fee_percentage": 0.003
  },
  "intelligence_optimized": true,
  "timestamp": 1704379200.0
}
```

##### `POST /api/v1/dex/pool/add-liquidity`
**Add liquidity to an existing pool**

**Request:**
```json
{
  "pool_id": "314ST_wBTC_1704379200",
  "provider_wallet": "pisecure_wallet_provider",
  "amount_a": 10000,
  "amount_b": 5
}
```

**Response:**
```json
{
  "liquidity_added": true,
  "liquidity_details": {
    "pool_id": "314ST_wBTC_1704379200",
    "liquidity_added": {"amount_a": 10000, "amount_b": 5},
    "reward_314st": 25
  },
  "intelligence_rewards_earned": 25,
  "timestamp": 1704379200.0
}
```

##### `POST /api/v1/dex/swap`
**Execute intelligent token swap with ML optimization**

**Request:**
```json
{
  "token_in": "314ST",
  "token_out": "wBTC",
  "amount_in": 1000,
  "user_wallet": "pisecure_wallet_user",
  "max_slippage": 0.01
}
```

**Response:**
```json
{
  "swap_coordinated": true,
  "swap_details": {
    "swap_id": "swap_1704379200_12345",
    "expected_out": 0.5,
    "min_out": 0.495,
    "pool_id": "314ST_wBTC_1704379200",
    "fee_amount": 3,
    "recommended_slippage": 0.01,
    "intelligence_optimized": true
  },
  "network_conditions": {
    "threat_level": "low",
    "recommended_approach": "standard"
  },
  "estimated_completion": "30_seconds",
  "timestamp": 1704379200.0
}
```

##### `GET /api/v1/dex/intelligence`
**Get comprehensive DEX intelligence and analytics**

**Response:**
```json
{
  "dex_intelligence": {
    "dex_health_score": 87,
    "active_pools": 3,
    "total_liquidity_314st": 150000,
    "trading_volume_24h": 25000,
    "pool_health_analysis": {
      "total_pools": 3,
      "healthy_pools": 3,
      "health_percentage": 100
    },
    "trading_patterns": {
      "peak_trading_hours": ["14:00-16:00 UTC"],
      "popular_pairs": ["314ST/wBTC", "314ST/wETH"],
      "average_trade_size": 500
    },
    "recommendations": [
      "Consider adding incentives for new liquidity pools"
    ],
    "intelligence_benefits": [
      "Optimal trade routing based on network conditions",
      "Threat-aware slippage limits",
      "Pool health monitoring and recommendations"
    ]
  },
  "intelligence_source": "bootstrap_coordinator",
  "network_intelligence_integrated": true,
  "timestamp": 1704379200.0
}
```

##### `GET /api/v1/dex/stats`
**Get DEX statistics and market data**

**Response:**
```json
{
  "dex_stats": {
    "total_pools": 3,
    "total_liquidity_314st": 150000,
    "trading_volume_24h": 25000,
    "popular_pairs": [
      {
        "pair": "314ST/wBTC",
        "pool_id": "314ST_wBTC_1704379200",
        "liquidity": 100000,
        "volume_24h": 15000,
        "trade_count": 200
      }
    ],
    "dex_health_score": 87
  },
  "intelligence_features": [
    "ML-optimized trade routing",
    "Threat-aware liquidity selection",
    "Network condition adaptation",
    "Real-time pool health monitoring"
  ],
  "timestamp": 1704379200.0
}
```

**Unique Features:**
- **Bootstrap-level coordination** with ML intelligence for optimal trading
- **Threat-aware routing** that adapts swap parameters based on network conditions
- **314ST rewards integration** for liquidity providers and DEX users
- **AMM (Automated Market Maker)** mechanics with dynamic fee adjustment
- **Intelligence-enhanced execution** using network health and threat analysis
- **Real-time pool health monitoring** with automated recommendations
- **Federated DEX coordination** across bootstrap nodes for unified liquidity

## Technical Architecture

### ML Models Used
- **Isolation Forest**: Unsupervised anomaly detection for attack identification
- **K-means Clustering**: Geographic region optimization
- **Statistical Analysis**: Z-score calculations, moving averages, time series
- **Reinforcement Learning**: Q-table route optimization

### Data Sources
- Real-time connection monitoring
- Geographic IP geolocation
- Latency measurements
- Service health metrics
- Network traffic patterns

### Security Features
- Service capability validation
- Geographic threat zone management
- Automated rate limiting
- Regional traffic blocking
- Threat intelligence sharing

### Performance Optimizations
- Connection data buffering (1000 entries)
- Geographic caching with database persistence
- Service load balancing algorithms
- Predictive scaling based on ML forecasts

## Deployment Considerations

### Environment Variables
- `FLASK_ENV`: Set to 'development' for debug mode
- `PORT`: Server port (default: 8080)

### Database Requirements
- SQLite database for persistent storage
- Automatic schema creation on startup
- Geo IP caching for performance

### Monitoring and Logging
- Comprehensive logging of all API calls
- ML model initialization status
- Attack detection events
- Service coordination activities

### Scaling Considerations
- Horizontal scaling with multiple bootstrap nodes
- Geographic distribution for global coverage
- Load balancing across service instances
- Database replication for high availability

This documentation covers the unique, advanced capabilities that make PiSecure Bootstrap Nodes significantly more intelligent and capable than traditional blockchain bootstrap services.